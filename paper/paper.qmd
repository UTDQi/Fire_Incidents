---
title: "The Causes of Damage in Toronto Fire Incidents"
author: 
  - David Qi
thanks: "Code and data are available at: https://github.com/UTDQi/Fire_Incidents"
date: today
date-format: long
abstract: "This paper discusses some basic findings around the monetary and lives loss in Toronto fire incidents. By using data from open data Toronto and choosing the relevant entries, we have identified possible factors that influences monetary and lives loss in fire incidents. We identified unattended ignition sources as a significant risk factor for civilian casualties, highlighting the need for public awareness campaigns to educate communities about these potential hazards. Interestingly, we observed that increasing the number of responding personnel beyond 90 led to a reduction in civilian casualties, which contrasts with our initial expectations."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)

#load data
#general data
analysis_data = read_csv(here::here("data/analysis_data/fire_incidents_data_general.csv"))

# date for comparison of dollar loss vs number responding personnel
analysis_data_personnel_dollarloss = read_csv(here::here("data/analysis_data/fire_incidents_data_respondPersonnel_Dollar_loss.csv"))

#data for time of event 
analysis_data_year = read_csv(here::here("data/analysis_data/fire_incidents_data_time.csv"))

# data for dollar loss
analysis_data_dollar_loss = read_csv(here::here("data/analysis_data/fire_incidents_data_dollar_loss.csv"))

# data for causes
analysis_data_cause = read_csv(here::here("data/analysis_data/fire_incidents_data_possible_cause.csv"))

# data for the graph that list average dollar loss and Civilian Casualties for each possible cause
analysis_data_cause_compare = read_csv(here::here("data/analysis_data/fire_incidents_data_cause_compare.csv"))

# data for Civilian_Casualties vs responding personnel graph
analysis_data_personnel_casualties = read_csv(here::here("data/analysis_data/fire_incidents_data_respondPersonnel_Casualties.csv"))
```


# Introduction

Fire incidents are a major threat to urban lifestyles, causing substantial loss of life and property. In recent years, there has been an increase in number of fire incidents reported in Toronto (@fig-years), which highlights the importance of identifying trends and patterns in historical data. These trends are toward conclusions on causation of casualties and monetary loss, which may further enable us to find areas of improvement for our fire services. As a simple comparison, we also used the fire incident data in Detroit from city of Detroit open data portal(@Detroit).By studying these data, we find that fire with undetermined cause on average create more property damage, unattended ignition sources is the greatest threat to civilians among the frequent fire causes, and personnel responding can lower the civilian causality when exceeding 90. 

In this paper, we make use R (@citeR) and the tidyverse package (@tidyverse). The data set is from Open Data Toronto (@opendatatoronto). The figures in our study are generated by ggplot (@ggplot2) . We also have used (@sigmoid) when simulating and testing with our data.

The remainder of this paper is structured as follows: We first give a brief overview of the dataset under [Data](#sec-data) section.Providing some basic information. Then, we use graphs and models to present the results we find from our data in the [Results](#results) section. We then discusses the possible interpretations of our find further in the [Discussion](#discussion) section. While also pointing our the weaknesses and areas for further investigations in the [Weaknesses and next steps](#next-step) section. 


# Data {#sec-data}

## Overview of dataset
The data set includes 32000 fire incidents from year 2011 to 2023. As description provided by open data Toronto(@opendatatoronto) tells us, "This dataset includes only fire incidents as defined by the Ontario Fire Marshal (OFM) up to December 31, 2023." 

The raw data set contains 43 columns, we have chooses 5 of them for further analysis. For each of the variables, some of the entries may be missing, each time we refer to the variables, we will removed the missing entries. The actual number of incidents presented in each graph will be mentioned before each figure. 

The selected variables are: estimated dollar loss, number of responding personnel, possible cause, TFS alarm time, and civilian causalities. We believe these variables have high correlations, and may suggest the reason for life and property loss. 

## Basic informations
This section provides basic information about some of the variables independently, without referencing other variables. 
This gives as an overview of the structure of our data, which will help us understand the results we find in analysis. 

To highlight the increased importance of our study, we first present the number of reported fire incidents each year in Toronto(@fig-years).
There are no missing entries in alarm time, so this figure includes 32000 incidents. 

```{r}
#| label: fig-years
#| fig-cap: Number of incidents recorded each year
#| echo: false
#| include: true
#| warning: false


# Count the number of incidents for each year
yearly_counts <- analysis_data_year %>%
  group_by(Year) %>%
  summarise(Incident_Count = n())

# Plot the number of incidents for each year
ggplot(yearly_counts, aes(x = Year, y = Incident_Count)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  theme_minimal() +
  labs(title = "Number of Incidents Each Year",
       x = "Year",
       y = "Number of Incidents") 
```

It is important to note the great increase of fire incidents from 2683 incidents in 2022 to 3457 in 2023. This may implies that as we reach the end of the end of covid pandemic, the threat of fire has increased due to increased human activities. If we compare this with other data on fire incidences, for example fire incidence in Detroit, we can find similar trends(@Detroit). 

We then present the distribution of estimated dollar loss on 23449 incidents(@fig-dollar-loss).

```{r}
#| label: fig-dollar-loss
#| fig-cap: Distribution of Estimated Dollar Loss
#| include: true
#| echo: false
#| warning: false
#| message: false


# Create a histogram of the Estimated_Dollar_Loss variable
ggplot(analysis_data_dollar_loss, aes(x = Estimated_Dollar_Loss)) +
  geom_histogram(binwidth = 5000, fill = "steelblue", color = "black") +
  theme_minimal() +
  labs(title = "Distribution of Estimated Dollar Loss",
       x = "Estimated Dollar Loss",
       y = "Frequency") +
  scale_x_continuous(labels = scales::dollar, limits = c(0, 200000))
```

The graph is similar to an exponential distribution. With a few peaks at 50, 100 and 150 thousand, due to the nature of this data is being estimated. 

We then present possible causes of fire on 23425 incidents.(@fig-causes)

```{r}
#| label: fig-causes
#| fig-cap: Count of incidents for each cause
#| include: true
#| echo: false
#| warning: false
#| message: false

# select relevant column, remove missing entries 
analysis_cause = analysis_data %>% select(Possible_Cause) %>% drop_na()

# Count occurrences of each fire cause
fire_cause_counts <- analysis_cause %>%
  group_by(Possible_Cause) %>%
  summarise(Count = n()) %>%
  arrange(desc(Count))  # Sort in descending order

top_fire_causes <- fire_cause_counts %>%
  top_n(10, Count)

# Create a graph displaying the counts as numbers
ggplot(top_fire_causes, aes(x = reorder(Possible_Cause, -Count), y = Count)) +
  geom_bar(stat = "identity", fill = "steelblue") +  # Create bars
  geom_text(aes(label = Count), vjust = -0.5, size = 4, color = "black") +  # Add count labels
  theme_minimal(base_size = 15) +  # Increase base font size for readability
  labs(title = "Top 10 Fire Causes by Count",
       x = "Possible Cause",
       y = "Count of Incidents") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6)) +  
  coord_cartesian(clip = "off")  # Allow labels to be displayed outside the plot area
```
  We see the three main causes of fire identified are: Electrical failure, Improperly discarded ignition source and Unattended ignition source. We will focus on these causes when we analysis the data.


# Results

## On Types of Causes

In this section, we use two figures that are from 23449 observations and identify the average dollar loss and causality of each cause of fire. The result provide us with understanding that in what way each type of fire are dangerous: some are more risky to human and some damages the property more.

From @fig-cause-compare-dollar and @fig-cause-compare-casualties,we see that among the top five causes of fires we identified,  each of them are substantially different in the damage they create.
Unattended ignition source is the most dangerous in causing death, but on average cause relatively less damage to properties. This suggests that causalities and property damage are different in nature and have to be treated differently. This observation also captures the nature of unattended unattended ignition sources, which often catch individuals off-guard, leading to a higher risk. 
The vast difference also highlights the importance of identifying the cause of fire, which may help us lower potential  property damage. And help us in understanding how to treat the fire.
The mean dollar loss for all causes of fire is 38,105.88, while the mean dollar loss for undetermined causes is significantly higher at 63,034. This indicates that fires of undetermined origin often result in more severe damage, possibly due to delayed detection and complex fire behavior. Undetermined fires are more likely to involve unusual circumstances, complicating both firefighting efforts and post-incident analysis. Understanding these patterns could be key for improving firefighting strategies.

It's important to note that a relatively low average damage does not imply that a fire cause is insignificant. For example, improperly discarded ignition sources may be relatively less damaging according to the figures. But it is the second most frequent single cause of fires Incidents. This category has contributed to over $20 million in losses and resulted in more than 110 civilian casualties. Such statistics indicates the need for proactive measures against seemingly less damaging causes, such as public education campaign or fines for improperly discarded cigarette. As these fire also are severe threats for public safety. 

```{r}
#| label: fig-cause-compare-dollar
#| fig-cap: Compare cause with dollar loss 
#| include: true
#| echo: false
#| warning: false
#| message: false


top_fire_causes <- analysis_data_cause_compare %>%
  top_n(5, Count)

ggplot(top_fire_causes, aes(x = reorder(Possible_Cause, -Count), y = Avg_Dollar_Loss)) +
  geom_bar(stat = "identity", fill = "steelblue", width = 0.6) +  # Adjust bar width
  geom_text(aes(label = round(Avg_Dollar_Loss)), size = 4, color = "black") +  # Add count labels
  theme_minimal(base_size = 15) +  # Increase base font size for readability
  labs(title = "Average Dollar Loss of Top 5 Fire Causes",
       x = "Possible Cause",
       y = "Average dollar loss") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),  # Rotate x-axis labels
        axis.text.y = element_text(size = 6),  # Increase y-axis text size
        plot.margin = margin(t = 20, r = 20, b = 20, l = 20),  # Add margins
        panel.grid.major.x = element_blank())  # Remove grid lines

```
```{r}
#| label: fig-cause-compare-casualties
#| fig-cap: Compare cause with civilian casualties
#| include: true
#| echo: false
#| warning: false
#| message: false


ggplot(top_fire_causes, aes(x = reorder(Possible_Cause, -Count), y = Avg_Civilian_Casualties)) +
  geom_bar(stat = "identity", fill = "orange", width = 0.6) +  # Adjust bar width
  geom_text(aes(label = round(Avg_Civilian_Casualties, 3)), size = 4, color = "black") +  # Add average casualties labels
  theme_minimal(base_size = 11) +  # Increase base font size for readability
  labs(title = "Average Civilian Casualties for Top 5 Causes",
       x = "Possible Cause",
       y = "Average Casualties") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),  # Rotate x-axis labels
        axis.text.y = element_text(size = 5),  # Increase y-axis text size
        plot.margin = margin(t = 20, r = 20, b = 20, l = 20),  # Add margins
        panel.grid.major.x = element_blank())  # Remove grid lines
```
\newpage

## Number of responding personnel

  In this section, we attempts to identify the relationship between the damage of the fire and number of responding personnel.

@fig-personcomparewithcasualties created from 25769 relevant observations, it draws out the relationship between number of responding personnel and civilian casualties. We can see as the number of personnel increases, the casualties increase, this behavior is expected since we would expect a more damaging fire to receive more attention. However, the average casualties reaches a peak when the personnel responding reaches 80-90, and decreases afterward. 

  It is possible that as number of personnel increases beyond 90, their organization becomes more effective.Or that exceeding 90 personnel allows them to use some of the highly effective apparatus. Our result suggest it may be worth looking into the incidents where more than 90 personnel responded, and find what makes them more effective.

```{r}
#| label: fig-personcomparewithcasualties
#| fig-cap: Compare responding personnel with civilian casualties
#| include: true
#| echo: false
#| warning: false
#| message: false

# 25769 observations
# Create bins for Number of Responding Personnel (0-10, 11-20, etc.)
analysis_data_personnel_casualties_hist <- analysis_data_personnel_casualties %>%
  mutate(Personnel_Bin = cut(Number_of_responding_personnel, 
                              breaks = seq(0, max(analysis_data_personnel_casualties$Number_of_responding_personnel, na.rm = TRUE), by = 10), 
                              right = FALSE, 
                              include.lowest = TRUE))

# Calculate average dollar loss for each personnel bin
analysis_data_personnel_casualties_hist  <-analysis_data_personnel_casualties_hist  %>%
  group_by(Personnel_Bin) %>%
  summarise(Average_Civilian_Casualties = ifelse(n() < 10, 0, mean(Civilian_Casualties, na.rm = TRUE)), Count = n()) %>%
  slice(1:20) # select only 20 bars

# Create a histogram of average dollar loss by personnel bin
ggplot(analysis_data_personnel_casualties_hist, aes(x = Personnel_Bin, y = Average_Civilian_Casualties)) +
  geom_col(fill = 'blue', color = 'black', alpha = 0.6) +  # Use geom_col() instead of geom_bar()
  labs(
    title = "Average Civilian Casualties by Responding Personnel",
    x = "Number of Responding Personnel",
    y = "Average Civilian Casualties"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_blank())
```

@fig-personcomparewithdollarloss is created from 23449 relevant observations, it draws out the relationship between number of responding personnel and dollar loss. We see that the damage of fire increases as number of personnel increase without exceptions. Which is our expected behavior and did not provide much insight comparing to @fig-personcomparewithcasualties. 



```{r}
#| label: fig-personcomparewithdollarloss
#| fig-cap: Compare responding personnel with dollar loss
#| include: true
#| echo: false
#| warning: false
#| message: false


# 23449 observations
# Create bins for Number of Responding Personnel (0-10, 11-20, etc.)
analysis_data_personnel_dollarloss_hist <- analysis_data_personnel_dollarloss %>%
  mutate(Personnel_Bin = cut(Number_of_responding_personnel, 
                              breaks = seq(0, max( analysis_data_personnel_dollarloss$Number_of_responding_personnel, na.rm = TRUE), by = 10), 
                              right = FALSE, 
                              include.lowest = TRUE))

# Calculate average dollar loss for each personnel bin
analysis_data_personnel_dollarloss_hist  <-analysis_data_personnel_dollarloss_hist  %>%
  group_by(Personnel_Bin) %>%
  summarise(Average_Dollar_Loss = ifelse(n() < 10, 0, mean(Estimated_Dollar_Loss, na.rm = TRUE)), Count = n()) %>%
  slice(1:20) # select only 20 bars

# Create a histogram of average dollar loss by personnel bin
ggplot(analysis_data_personnel_dollarloss_hist, aes(x = Personnel_Bin, y = Average_Dollar_Loss)) +
  geom_col(fill = 'blue', color = 'black', alpha = 0.6) +  # Use geom_col() instead of geom_bar()
  labs(
    title = "Average Dollar Loss by Responding Personnel",
    x = "Number of Responding Personnel",
    y = "Average Dollar Loss"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_blank()) 
```

# Discussion

## On Types of Causes {#sec-first-point}

  The cause of a fire significantly influences the extent of fire damage, as different causes lead to difference in spread rate, weather it is noticeable, and the types of hazards present. Understanding the relationship between fire causes and damage helps us in both fire prevention and effective firefighting. 
  Our result points out the importance in identifying the cause of fire in firefighting. The vast difference between damaged created by undetermined fire comparing to others indicates the help identifying the source and cause of fire can bring. 
  We have also identified unattended ignition sources as a high-risk factor for civilian casualties. To lower this risk, public awareness campaigns should be implemented to educate people about the potential dangers of leaving stoves, cigarettes, or heat guns unattended. By increasing awareness of these hazards and promoting safe practices, the likelihood of accidental fires and related casualties can be significantly reduced.

## Number of responding personnel

  The number of responding personnel, such as firefighters and emergency medical teams, plays a critical role in determining the outcomes of fire incidents involving casualties and property damage. From our analysis, we observed an unexpected decline in the number of casualties when the number of responding personnel exceeds 90, highlighting a key area for further study. Since the fire incident site involves complex decision-making and coordination, it is vital to avoid both overstaffing and understaffing in order to maintain an effective and manageable response team.
  
  Our study have shown that increasing the number of responding personnel doesn't substantially decrease property loss as the effect it has on civilian causalities. While we observed that a higher number of personnel reduces civilian casualties, the same effect is not observed in property loss. This distinction suggests that the effectiveness of firefighting operations may be more closely related to the effectiveness of each person, the ability of each person at sight, rather than number of person present. Future studies should explore the underlying reasons for this difference in relationship.

## Weaknesses and next steps{#next-step}

  Our study may have certain weaknesses that needs to be addressed in further studies. It also have point out potential area for further investigation. 
  
  Currently, we have not ensured that dollar losses are estimated consistently throughout these years. Changes in the workflow for how these estimations are made may reduce the effectiveness of our analysis. Future studies should focus on ensuring that these estimations are consistent and consider adjustments for inflation to provide more accurate and reliable results.
  
  Additionally, we have not considered other changes in the workflow, for example, improving on identification of fire causes and firefighting apparatus. These changes may cause our analysis which involves a lot of past data ineffective in current time. Future studies should attempt to ensure consistency in all these factors.

  We have noted that examining the existing organization of incidents where the number of responding personnel exceeds 90 may bring understandings into the reasons behind the observed decrease in casualties. Understanding the factors that contribute to this reduction can contribute to better resource allocation and emergency response management. 
  
## Conclusion
  In the background of increasing fire incidences after the covid pandemic, our study developed critical relationship between the causes of fires, the number of responding personnel, and the resulting impact on casualties and property damage. Which suggests future focus on area of public campaign, identification of fire cause, and fire site management. 

  
\newpage

# References


