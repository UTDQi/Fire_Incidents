---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - David Qi
thanks: "Code and data are available at: https://github.com/UTDQi/starter_folder"
date: today
date-format: long
abstract: "This paper discusses some basic findings around the monetary and lives loss in Toronto fire incidents. By using data from open data Toronto and choosing the relevant entries, we have identified possible factors that influences monetary and lives loss in fire incidents. "
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)

#load data
analysis_data = read_csv(here::here("data/analysis_data/fire_incidents_data_general.csv"))
data_fig_2 = read_csv(here::here("data/analysis_data/fire_incidents_data_respondPersonnel_Dollar_loss.csv"))
analysis_data_year = read_csv(here::here("data/analysis_data/fire_incidents_data_time.csv"))
analysis_data_dollar_loss = read_csv(here::here("data/analysis_data/fire_incidents_data_dollar_loss.csv"))
analysis_data_cause = read_csv(here::here("data/analysis_data/fire_incidents_data_possible_cause.csv"))
```


# Introduction

Fire incidents are a major threat to urban lifestyles, causing substantial loss of life and property. In recent years, there has been an increase in number of fire incidents reported in Toronto (@fig-years), which highlights the importance of identifying trends and patterns in historical data. These trends can provide helpful insights on causation of casualties and monetary loss, which may further enable us to find areas of improvement for our fire services.

In this paper, we make use R (@citeR) and the tidyverse package (@tidyverse). The data set is from Open Data Toronto (@opendatatoronto). The figures in our study are generated by ggplot (@ggplot2) . We also have used (@sigmoid) when simulating and testing with our data.

The remainder of this paper is structured as follows: We first give a brief overview of the dataset under [Data](@sec-data) section.Providing some basic information. Then, we use graphs and models to present the results we find from our data in the [results](@results) section. We then discusses the possible interpretations of our find further in the [discussion](@discussion) section. While also pointing our the weaknesses and areas for further investigations in the [Weaknesses and next steps](@next-step) section. 


# Data {#sec-data}

## Overview of dataset
The data set includes 32000 fire incidents from year 2011 to 2023. As description provided by open data Toronto(@opendatatoronto) tells us, "This dataset includes only fire incidents as defined by the Ontario Fire Marshal (OFM) up to December 31, 2023." 

The raw data set contains 43 columns, we have chooses 5 of them for further analysis. For each of the variables, some of the entries may be missing, each time we refer to the variables, we will removed the missing entries. The actual number of incidents presented in each graph will be mentioned before each figure. 

The selected variables are: estimated dollar loss, number of responding personnel, possible cause, TFS alarm time, and civilian causalities. We believe these variables have high correlations, and may suggest the reason for life and property loss. 

## Basic informations
This section provides basic information about some of the variables independently, without referencing other variables. 
This gives as an overview of the structure of our data, which will help us understand the results we find in analysis. 

To highlight the increased importance of our study, we first present the number of reported fire incidents each year in Toronto(@fig-years).
There are no missing entries in alarm time, so this figure includes 32000 incidents. 

```{r}
#| label: fig-years
#| fig-cap: Number of incidents recorded each year
#| echo: false
#| include: true
#| warning: false


# Count the number of incidents for each year
yearly_counts <- analysis_data_year %>%
  group_by(Year) %>%
  summarise(Incident_Count = n())

# Plot the number of incidents for each year
ggplot(yearly_counts, aes(x = Year, y = Incident_Count)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  theme_minimal() +
  labs(title = "Number of Incidents Each Year",
       x = "Year",
       y = "Number of Incidents") 
```

It is important to note the great increase of fire incidents from 2683 incidents in 2022 to 3457 in 2023. This may implies that as we reach the end of the end of covid pandemic, the threat of fire has increased due to increased human activities. 

We then present the distribution of estimated dollar loss on 23449 incidents(@fig-dollar-loss).

```{r}
#| label: fig-dollar-loss
#| fig-cap: Distribution of Estimated Dollar Loss
#| include: true
#| echo: false
#| warning: false
#| message: false


# Create a histogram of the Estimated_Dollar_Loss variable
ggplot(analysis_data_dollar_loss, aes(x = Estimated_Dollar_Loss)) +
  geom_histogram(binwidth = 5000, fill = "steelblue", color = "black") +
  theme_minimal() +
  labs(title = "Distribution of Estimated Dollar Loss",
       x = "Estimated Dollar Loss",
       y = "Frequency") +
  scale_x_continuous(labels = scales::dollar, limits = c(0, 200000))
```

The graph is similar to an exponential distribution. With a few peaks at 50, 100 and 150 thousand, due to the nature of this data is being estimated. 

We then present possible causes of fire on 23425 incidents.(@fig-causes)

```{r}
#| label: fig-causes
#| fig-cap: Count of incidents for each cause
#| include: true
#| echo: false
#| warning: false
#| message: false

# select relevant column, remove missing entries 
analysis_cause = analysis_data %>% select(Possible_Cause) %>% drop_na()

# Count occurrences of each fire cause
fire_cause_counts <- analysis_cause %>%
  group_by(Possible_Cause) %>%
  summarise(Count = n()) %>%
  arrange(desc(Count))  # Sort in descending order

top_fire_causes <- fire_cause_counts %>%
  top_n(10, Count)

# Create a graph displaying the counts as numbers
ggplot(top_fire_causes, aes(x = reorder(Possible_Cause, -Count), y = Count)) +
  geom_bar(stat = "identity", fill = "steelblue") +  # Create bars
  geom_text(aes(label = Count), vjust = -0.5, size = 4, color = "black") +  # Add count labels
  theme_minimal(base_size = 15) +  # Increase base font size for readability
  labs(title = "Top 10 Fire Causes by Count",
       x = "Possible Cause",
       y = "Count of Incidents") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6)) +  
  coord_cartesian(clip = "off")  # Allow labels to be displayed outside the plot area
```
  We see the three main causes of fire identified are: Electrical failure, Improperly discarded ignition source and Unattended ignition source. We will focus on these causes when we analysis the data.

# Model


## Model set-up



### Model justification



# Results

Our results are summarized in @tbl-modelresults.



# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps{#next-step}

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check


## Diagnostics



\newpage


# References


